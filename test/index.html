<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Coalesce Tests</title>
    <link rel="stylesheet" href="vendor/mocha/mocha.css">
</head>
<body>
    <div id="mocha"></div>

    <!-- ES6 -->
    <script src="vendor/babel-core/browser-polyfill.js"></script>
    <script src="vendor/babel-core/external-helpers.js"></script>
    <script src="vendor/es6-module-loader/dist/es6-module-loader.js"></script>
    <script src="vendor/systemjs/lib/extension-register.js"></script>

    <!-- https://github.com/ModuleLoader/es6-module-loader/wiki/Production-Workflows -->
    <script type="text/javascript">
      register(System);
    </script>

    <!-- Coalesce dependencies -->
    <script src="vendor/jquery/dist/jquery.js"></script>
    <script src="vendor/lodash/lodash.js"></script>
    <script src="vendor/backburner.js"></script>

    <!-- Testing dependencies -->
    <script src="vendor/sinonjs/sinon.js"></script>
    <script src="vendor/mocha/mocha.js"></script>
    <script src="vendor/mocha-lazy-bdd/dist/mocha-lazy-bdd.js"></script>
    <script src="vendor/chai/chai.js"></script>
    <script src="/testem.js"></script>

    <!-- Coalesce modules -->
    <script src="../coalesce.system.js"></script>
    <script src="coalesce-test.system.js"></script>

    <script>
        mocha.setup('lazy-bdd');
        var expect = chai.expect;

        System.import('coalesce').then(function() {

          System.import('coalesce-test/support/server').then(function() {

            var promises = [];
            Object.keys(System.defined).forEach(function(moduleName) {
              if ((/coalesce\-test/).test(moduleName)) {
                promises.push(System.import(moduleName));
              }
            });

            Promise.all(promises).then(function() {
              mocha.run();
            });


          });

        });
    </script>
</body>
</html>
